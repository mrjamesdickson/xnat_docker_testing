global
  maxconn 200

defaults
  log     global
  mode    tcp
  option  tcplog
  timeout connect 5s
  timeout client  30m
  timeout server  30m

frontend postgres
  bind *:5432
  default_backend postgres_cluster

backend postgres_cluster
  mode tcp
  option httpchk GET /master
  http-check expect status 200
  default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
  server patroni-primary patroni-primary:5432 check port 8008
  server patroni-replica1 patroni-replica1:5432 check port 8008
